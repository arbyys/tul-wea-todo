{% extends "base.html" %}

{% block content %}

<main class="padded">
    <header class="header mb-4">
        <span class="has-text-info has-text-weight-bold">></span>
        <span>task list</span>
        <span class="has-text-info">(user <b>{{ current_user.username }}</b>)</span>
    </header>
    
    <div class="form-wrapper-bigger mt-5">
        <form hx-put="/list/create"
              hx-swap="innerHTML"
              hx-on::after-request="this.reset()">
            <label class="label has-text-info">create new</label>
            <div class="field is-grouped pl-3 mt-4">
                <div class="control">
                    <input class="input is-info" type="text" name="title" id="title" placeholder="title">
                </div>
                <div class="control is-expanded">
                    <input class="input is-info" type="text" name="content" id="content" placeholder="content">
                </div>
                <div class="control">
                    <button class="button is-info is-fullwidth" type="submit" title="create">
                        <span class="icon">
                        <i class="fas fa-plus"></i>
                        </span>
                    </button>
                </div>
            </div>
        </form>
    </div>

    <div class="mt-5">
        <label class="label has-overflow-ellipsis has-text-info">list</label>
        
        <div class="search-wrapper ml-3">

            <input class="input is-info w-25" type="search" id="search" name="query" placeholder="filter tasks"
                    hx-get="/list/tasks"
                    hx-trigger="input changed delay:400ms"
                    hx-target="#task-list"
                    hx-swap="innerHTML"
                    hx-indicator="#spinner-search">

            <img id="spinner-search" class="spinner-search htmx-indicator" src="{{ url_for('static', filename='img/loader.svg') }}" />

        </div>

        <div id="task-list" 
            hx-get="/list/tasks"
            hx-include="#search" 
            hx-trigger="load, updateList from:body" 
            hx-swap="innerHTML">

        </div>
    </div>


    <div class="settings mt-5">
        <label class="label has-text-info">settings</label>
        <div class="pl-3 mt-4">
         todo
        </div>
    </div>
</main>

{% endblock %}